"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[850],{6571:function(n,e,t){t(2791);e.Z=t.p+"static/media/logo.ccfbd90732828204fa6989c0f15638c0.svg"},7997:function(n,e,t){t.r(e),t.d(e,{default:function(){return $}});var r,a,i,s=t(885),c=t(2791),o=t(9910),d=t(6871),u=t(168),f=t(6031),m=f.ZP.div(r||(r=(0,u.Z)(["\n    height: 100vh;\n    width: 100vw;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    gap: 1rem;\n    align-items: center;\n    background: #131324;\n    .container {\n        height: 85vh;\n        width: 85vw;\n        background: #00000076;\n        display: flex;\n        @media screen and (max-width: 600px) {\n            height: 100vh;\n            width: 100vw;\n        }\n    }\n"]))),l=t(7261),h=f.ZP.div(a||(a=(0,u.Z)(["\n    width: 25%;\n    display: grid;\n    padding-top: 1rem;\n    grid-template-rows: 10% 78% 12%;\n    overflow: hidden;\n    background: #090424;\n    @media screen and (max-width: 1080px) {\n        width: 15%;\n        grid-template-rows: 15% 70% 15%;\n    }\n    .brand {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 1rem;\n        img {\n            height: 2rem;\n        }\n        h3 {\n            color: #fff;\n            text-transform: uppercase;\n        }\n        @media screen and (max-width: 1080px) {\n            h3 {\n                display: none;\n            }\n        }\n    }\n    .contacts {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        overflow: auto;\n        gap: 1rem;\n        padding: 1rem 0;\n        &::-webkit-scrollbar {\n            width: 0.2rem;\n            &-thumb {\n                background: #ffffff39;\n                width: 0.1rem;\n                border-radius: 1rem;\n            }\n        }\n        .contact {\n            background: #ffffff39;\n            min-height: 4.5rem;\n            width: 90%;\n            cursor: pointer;\n            border-radius: 0.2rem;\n            padding: 0.4rem;\n            gap: 1rem;\n            align-items: center;\n            display: flex;\n            transition: 0.5s ease-in-out;\n            position: relative;\n            @media screen and (max-width: 1080px) {\n                justify-content: center;\n                min-height: 4rem;\n                background: none;\n            }\n            .avatar {\n                img {\n                    height: 3rem;\n                }\n            }\n            .username {\n                h3 {\n                    color: #fff;\n                }\n                @media screen and (max-width: 1080px) {\n                    display: none;\n                }\n            }\n        }\n        .selected {\n            background: #9186f3;\n        }\n    }\n    .currentUser {\n        padding: 0.5rem;\n        background: #0d0d30;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: 1.5rem;\n        cursor: pointer;\n        .avatar {\n            img {\n                height: 50px; \n                max-inline-size: 100%;\n            }\n        }\n        .username {\n            h2 {\n                color: #fff;\n            }\n            @media screen and (max-width: 1080px) {\n                display: none;\n            }\n        }\n    }\n"]))),p=t(6571),g=f.ZP.span(i||(i=(0,u.Z)(["\n    &.badge {\n        position: absolute;\n        top: -7px;\n        right: 4px;\n        padding: 2px 2px;\n        border-radius: 20%;\n        background: #090424;\n        color: #fff;\n        @media screen and (max-width: 1080px) {\n            font-size: 0.75rem;\n        }\n        @media screen and (max-width: 768px) {\n            font-size: 0.65rem;\n        }\n        @media screen and (max-width: 500px) {\n            font-size: 0.6rem;\n        }\n        @media screen and (max-width: 400px) {\n            font-size: 0.55rem;\n        }\n    }\n"]))),x=t(184);function v(n){var e=n.text;return(0,x.jsx)(g,{className:"badge",children:e})}var w=t.p+"static/media/no-avatar.4a000e6c2f82b9781b22d2b01718e785.svg",b=t(8012),j=t(5345);function k(n){var e=n.setContacts,t=n.contact,r=n.user,a=(0,c.useContext)(o.S),i=a.dispatch,s=a.user,d=r?(0,x.jsx)("img",{src:"data:image/svg+xml;base64,".concat(r.avatarImage),alt:"avatar"}):(0,x.jsx)("img",{src:t.avatarImage?"data:image/svg+xml;base64,".concat(t.avatarImage):w,alt:"avatar"}),u=r?(0,x.jsx)("h2",{children:r.username}):(0,x.jsx)("h3",{children:t.username});return(0,c.useEffect)((function(){return b.Z.socket.on("unread-msg-receive",(function(n){i((0,j.Rl)(n)),e((function(e){return e.sort((function(e,t){return n.unreadMessages.includes(t._id)-n.unreadMessages.includes(e._id)})),e}))})),function(){b.Z.socket.off("unread-msg-receive")}}),[t]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"avatar",children:d}),(0,x.jsx)("div",{className:"username",children:u}),t&&s&&s.unreadMessages.includes(t._id)&&(0,x.jsx)(v,{text:"NEW"})]})}function Z(n){var e=n.setContacts,t=n.contacts,r=n.onChatChange,a=n.currentChat,i=(0,c.useContext)(o.S).user;return(0,x.jsxs)(h,{children:[(0,x.jsxs)("div",{className:"brand",children:[(0,x.jsx)("img",{src:p.Z,alt:"logo"}),(0,x.jsx)("h3",{children:"chaty"})]}),(0,x.jsx)("div",{className:"contacts",children:t.map((function(n){return(0,x.jsx)("div",{onClick:function(){return r(n)},className:"contact ".concat(n._id===(null===a||void 0===a?void 0:a._id)?"selected":""),children:(0,x.jsx)(k,{setContacts:e,contact:n})},n._id)}))}),(0,x.jsx)("div",{onClick:function(){return r(null)},className:"currentUser",children:(0,x.jsx)(k,{user:i})})]})}var y,C=t.p+"static/media/robot.0617a41936621e9697cd.gif",N=f.ZP.div(y||(y=(0,u.Z)(["\n    width: 75%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    color: #fff;\n    gap: 0.5rem;\n    padding: 0 1rem;\n    @media screen and (max-width: 1080px) {\n        width: 85%;\n    }\n    img {\n        height: 20rem;\n    }\n    h1 {\n        text-align: center;\n    }\n    h3 {\n        text-align: center;\n    }\n    span {\n        color: #4e00ff;\n    }\n"])));function S(){var n=(0,c.useContext)(o.S).user;return(0,x.jsxs)(N,{children:[(0,x.jsx)("img",{src:C,alt:"Robot"}),(0,x.jsxs)("h1",{children:["Welcome, ",(0,x.jsxs)("span",{children:[n.username,"!"]})]}),(0,x.jsx)("h3",{children:"Please select a chat to Start Messaging."})]})}var E,z,_=t(2982),M=f.ZP.div(E||(E=(0,u.Z)(["\n    width: 75%;\n    padding-top: 1rem;\n    display: grid;\n    grid-template-rows: 10% 78% 12%;\n    gap: 0.1rem;\n    overflow: hidden;\n    @media screen and (max-width: 1080px) {\n        grid-template-rows: 15% 70% 15%;\n        width: 85%;\n    }\n    .chatHeader {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 0 2rem;\n        @media screen and (max-width: 768px) {\n            padding: 0 1.5rem;\n        }\n        @media screen and (max-width: 500px) {\n            padding: 0 1rem;\n        }\n        .userDetails {\n            display: flex;\n            align-items: center;\n            gap: 1rem;\n            .avatar {\n                img {\n                    height: 3rem;\n                }\n            }\n            .username {\n                h3 {\n                    color: #fff;\n                }\n            }\n        }\n    }\n    .chatMessages {\n        padding: 1rem 2rem;\n        display: flex;\n        flex-direction: column;\n        gap: 1rem;\n        overflow: auto;\n        &::-webkit-scrollbar {\n            width: 0.2rem;\n            &-thumb {\n                background: #ffffff39;\n                width: 0.1rem;\n                border-radius: 1rem;\n            }\n        }\n        @media screen and (max-width: 768px) {\n            padding: 0 1.5rem;\n        }\n        @media screen and (max-width: 500px) {\n            padding: 0 1rem;\n        }\n        .message {\n            display: flex;\n            align-items: center;\n            .content {\n                max-width: 40%;\n                overflow-wrap: break-word;\n                padding: 1rem;\n                font-size: 1.1rem;\n                border-radius: 1rem;\n                color: #d1d1d1;\n            }\n            @media screen and (max-width: 768px) {\n                p {\n                    font-size: 1rem;\n                }\n            }\n            @media screen and (max-width: 500px) {\n                p {\n                    font-size: 0.9rem;\n                }\n            }\n        }\n        .sended {\n            justify-content: flex-end;\n            .content {\n                background: #4f04ff21;\n            }\n        }\n        .received {\n            justify-content: flex-start;\n            .content {\n                background: #9900ff20;\n            }\n        }\n    }\n"]))),I=t(9112),R=t(8174),P=(t(5462),t(7692));function A(){var n=(0,d.s0)(),e=(0,c.useContext)(o.S),t=e.dispatch,r=e.user;return(0,x.jsx)(D,{onClick:function(){(0,I.kS)().then((function(e){var a=e.data;b.Z.socket.emit("remove-user",r._id),R.Am.success(a.message),t((0,j.Rl)(null)),n("/login")})).catch((function(n){var e=n.response;R.Am.error(e)}))},children:(0,x.jsx)(P.t7h,{})})}var L,D=f.ZP.button(z||(z=(0,u.Z)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 0.5rem;\n    border-radius: 0.5rem;\n    background: #9a86f3;\n    cursor: pointer;\n    border: none;\n    svg {\n        font-size: 1.3rem;\n        color: #ebe7ff;\n    }\n"]))),U=t(2975),H=t.n(U),W=t(4373),F=t(9126),J=f.ZP.div(L||(L=(0,u.Z)(["\n    display: flex;\n    align-items: center;\n    background: #090424;\n    padding: 0 2rem;\n    gap: 1rem;\n    @media screen and (max-width: 768px) {\n        padding: 0 1.5rem;\n    }\n    @media screen and (max-width: 500px) {\n        padding: 0 1rem;\n    }\n    .buttonContainer {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: #fff;\n        gap: 1rem;\n        .emoji {\n            position: relative;\n            svg {\n                font-size: 1.5rem;\n                color: #ffff00c8;\n                cursor: pointer;\n            }\n            .emoji-picker-react {\n                position: absolute;\n                top: -350px;\n                background: #080420;\n                box-shadow: 0 5px 10px #9a86f3;\n                border-color: #9186f3;\n                .emoji-scroll-wrapper::-webkit-scrollbar {\n                    background: #080420;\n                    width: 5px;\n                    &-thumb {\n                        background: #9186f3;\n                    }\n                }\n                .emoji-categories {\n                    button {\n                        filter: contrast(0);\n                    }\n                }\n                .emoji-search {\n                    background: transparent;\n                    border-color: #9186f3;\n                }\n                .emoji-group:before {\n                    background: #080420;\n                }\n            }\n        }\n    }\n    .inputContainer {\n        width: 100%;\n        border-radius: 2rem;\n        display: flex;\n        align-content: center;\n        background: #ffffff34;\n        input {\n            width: 90%;\n            background: transparent;\n            color: #fff;\n            border: none;\n            padding: 0 1rem;\n            font-size: 1.2rem;\n            &::selection {\n                background: #9186f3;\n            }\n            &:focus {\n                outline: none;\n            }\n            @media screen and (max-width: 768px) {\n                font-size: 1rem;\n            }\n            @media screen and (max-width: 500px) {\n                font-size: 0.9rem;\n            }\n        }\n        button {\n            padding: 0.3rem 2rem;\n            border-radius: 2rem;\n            display: flex\n            justify-content: center;\n            align-items: center;\n            background: #9a86f3;\n            border: none;\n            cursor: pointer;\n            @media screen and (max-width: 768px) {\n                padding: 0.3rem 1.5rem;\n            }\n            @media screen and (max-width: 500px) {\n                padding: 0.3rem 1.25rem;\n            }\n            svg {\n                font-size: 2rem;\n                color: #fff;\n            }\n        }\n    }\n"]))),V=function(n,e){(0,c.useEffect)((function(){var t=function(t){n.current&&!n.current.contains(t.target)&&e(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[n,e])},q=function(n,e){function t(t){t.key===n&&e()}(0,c.useEffect)((function(){return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[n,e])};function B(n){var e=n.currentChat,t=n.onSendMessage,r=(0,c.useState)(!1),a=(0,s.Z)(r,2),i=a[0],o=a[1],d=(0,c.useState)(""),u=(0,s.Z)(d,2),f=u[0],m=u[1],l=(0,c.useRef)();V(l,(function(){return o(!1)})),q("Escape",(function(){return o(!1)})),(0,c.useEffect)((function(){""!==f&&m("")}),[e]);return(0,x.jsxs)(J,{children:[(0,x.jsx)("div",{className:"buttonContainer",children:(0,x.jsxs)("div",{className:"emoji",children:[(0,x.jsx)(F.IZ1,{onClick:function(){o((function(n){return!n}))}}),i&&(0,x.jsx)("div",{ref:l,children:(0,x.jsx)(H(),{onEmojiClick:function(n,e){m((function(n){return n+e.emoji}))}})})]})}),(0,x.jsxs)("form",{onSubmit:function(n){n.preventDefault(),f.length>0&&(t(f),m(""))},className:"inputContainer",children:[(0,x.jsx)("input",{onChange:function(n){m(n.target.value)},value:f,type:"text",placeholder:"type your message..."}),(0,x.jsx)("button",{className:"submit",children:(0,x.jsx)(W.ghy,{})})]})]})}var G=t(4165),K=t(5861),O=t(2232),Q=function(){var n=(0,K.Z)((0,G.Z)().mark((function n(e){var t;return(0,G.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.Z.get("messages?otherUser=".concat(e),{withCredentials:!0});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),T=function(){var n=(0,K.Z)((0,G.Z)().mark((function n(e){var t;return(0,G.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.Z.post("messages",e,{withCredentials:!0});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),X=t(4261);function Y(n){var e=n.currentChat,t=(0,c.useState)([]),r=(0,s.Z)(t,2),a=r[0],i=r[1],d=(0,c.useState)(!0),u=(0,s.Z)(d,2),f=u[0],m=u[1],h=(0,c.useContext)(o.S),p=h.dispatch,g=(h.user,(0,c.useRef)());(0,c.useEffect)((function(){var n;null===(n=g.current)||void 0===n||n.scrollIntoView({behaviour:"smooth"})}),[a]),(0,c.useEffect)((function(){return b.Z.socket.on("msg-receive",(function(n){n.sender===e._id&&((0,l.zM)(e._id).then((function(n){var e=n.data;p((0,j.Rl)(e))})).catch((function(n){var e=n.response;console.log(e)})),i((function(e){return[].concat((0,_.Z)(e),[n])})))})),function(){b.Z.socket.off("msg-receive")}}),[e]),(0,c.useEffect)((function(){m(!0),Q(e._id).then((function(n){var e=n.data;i(e)})).catch((function(n){var e=n.response;console.log(e)})).finally((function(){m(!1)}))}),[e]);return f?null:(0,x.jsxs)(M,{children:[(0,x.jsxs)("div",{className:"chatHeader",children:[(0,x.jsxs)("div",{className:"userDetails",children:[(0,x.jsx)("div",{className:"avatar",children:(0,x.jsx)("img",{src:e.avatarImage?"data:image/svg+xml;base64,".concat(e.avatarImage):w,alt:"avatar"})}),(0,x.jsx)("div",{className:"username",children:(0,x.jsx)("h3",{children:e.username})})]}),(0,x.jsx)(A,{})]}),(0,x.jsx)("div",{className:"chatMessages",children:a.map((function(n){return(0,x.jsx)("div",{ref:g,children:(0,x.jsx)("div",{className:"message ".concat(n.sender===e._id?"received":"sended"),children:(0,x.jsx)("div",{className:"content",children:(0,x.jsx)("p",{children:n.text})})})},(0,X.Z)())}))}),(0,x.jsx)(B,{currentChat:e,onSendMessage:function(n){if(0!==n.trim().length){var t={text:n,recipient:e._id};T(t).then((function(n){var e=n.data;i((function(n){return[].concat((0,_.Z)(n),[e])}))})).catch((function(n){var e=n.response;console.log(e)}))}}})]})}function $(){var n=(0,c.useState)([]),e=(0,s.Z)(n,2),t=e[0],r=e[1],a=(0,c.useState)(null),i=(0,s.Z)(a,2),u=i[0],f=i[1],h=(0,c.useContext)(o.S),p=h.dispatch,g=h.user,v=(0,d.s0)();(0,c.useEffect)((function(){g&&b.Z.socket.emit("add-user",g._id)}),[]),(0,c.useEffect)((function(){g.isAvatarImageSet?(0,l.Rf)().then((function(n){var e=n.data;e.sort((function(n,e){return g.unreadMessages.includes(e._id)-g.unreadMessages.includes(n._id)})),r(e)})).catch((function(n){var e=n.response;console.log(e)})):v("/setAvatar")}),[g.isAvatarImageSet]);return(0,x.jsx)(m,{children:(0,x.jsxs)("div",{className:"container",children:[(0,x.jsx)(Z,{setContacts:r,currentChat:u,onChatChange:function(n){f(n),n&&g.unreadMessages.includes(n._id)&&(0,l.zM)(n._id).then((function(n){var e=n.data;p((0,j.Rl)(e))})).catch((function(n){var e=n.response;console.log(e)}))},contacts:t}),u?(0,x.jsx)(Y,{currentChat:u}):(0,x.jsx)(S,{})]})})}},7261:function(n,e,t){t.d(e,{J3:function(){return s},Rf:function(){return c},zM:function(){return o}});var r=t(4165),a=t(5861),i=t(2232),s=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.Z.put("users/setAvatar",e,{withCredentials:!0});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.Z.get("users",{withCredentials:!0});case 2:return e=n.sent,n.abrupt("return",e);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),o=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.Z.delete("users/unreadMessages/".concat(e),{withCredentials:!0});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}]);
//# sourceMappingURL=850.721bf344.chunk.js.map